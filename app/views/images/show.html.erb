<div class="relative pt-5 pb-10 px-4 sm:px-6 lg:pt-10 lg:pb-28 lg:px-8">
  <h1 class="text-4xl font-bold text-blue-600 mb-6 text-center">
    <%= @image.label %>
  </h1>
  <div class="text-center text-gray-600 mb-6">
    <p><%= @image.display_description %></p>
  </div>

  <div class="mx-auto max-w-4xl flex flex-wrap justify-around bg-white p-4 rounded-lg shadow-md" data-controller="wait">
    <div class="w-full md:w-1/3 p-4">
      <%= render "images/doc_form", image: @image %>
    </div>
    
    <div class="w-full md:w-1/3 my-6 md:my-0">
      <h1 class="text-4xl font-bold text-gray-800 text-center">OR</h1>
      <div class="hidden">
        <div class="flex justify-center">
          <div class="animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-gray-900"></div>
        </div>
        <p class="text-center text-gray-600">Processing image...</p>
      </div>
    </div>

    <div class="w-full md:w-1/3 p-4">
      <%= button_to "Generate AI Image", generate_image_path(@image), 
            method: :post, 
            class: "bg-green-600 hover:bg-green-700 p-3 m-2 rounded-lg text-white w-full", 
            data: {action: "click->disable#disableForm"}  unless @image.status == "error" %>

          <p class="text-center text-gray-600">
            <%= @image.image_prompt %>
          </p>
          <p class="text-center text-gray-600">
            <%= @image.status %>
          </p>
    </div>
  </div>

  <%= turbo_stream_from :doc_list %>
  <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6 mt-6" id="<%=@image.id%>_docs_list">
    <%# <%= render @image.docs_for_user(current_user), current_user: current_user %>
    <% @image.docs.each do |doc| %>
      <%= render "docs/doc", doc: doc, viewing_user: current_user %>
    <% end %>
  </div>

  <div class="mt-6 flex justify-center space-x-4">
    <%= button_to "Edit this image", edit_image_path(@image), method: :get, class: "text-blue-500 hover:text-blue-700 font-medium py-2 px-4 rounded-md" %>
    <%= button_to "Back to images", images_path, method: :get, class: "text-blue-500 hover:text-blue-700 font-medium py-2 px-4 rounded-md" %>
    <%= button_to "Destroy this image", @image, method: :delete, class: "text-red-500 hover:text-red-700 font-medium py-2 px-4 rounded-md" %>
  </div>
</div>
