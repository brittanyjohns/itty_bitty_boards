<div class="relative pt-5 pb-10 px-4 sm:px-6 lg:pt-10 lg:pb-28 lg:px-8">
  <h1 class="text-4xl font-bold text-blue-600 mb-6 text-center">
    <%= @image.label %>
  </h1>
  <div class="text-center my-4 py-5">
    <% @image.boards.each do |board| %>
      <%= link_to "Back to #{board.name}", board_path(board), class: "text-lg text-blue-600 hover:underline block" %>
    <% end %>
  </div>
  <div class="text-center text-gray-600 mb-6">
    <p><%= @image.display_description %></p>
  </div>

  <div class="mx-auto max-w-4xl flex flex-wrap justify-around bg-white p-4 rounded-lg shadow-md" >
    <div class="w-full md:w-1/3 p-4">
      <%= render "images/doc_form", image: @image %>
    </div>
    <div class="w-full md:w-1/3 p-4 text-center">
      <h2 class="text-xl font-semibold">OR</h2>
      <% unless @ready_to_send %>
    <div class="bg-green-500 p-6 rounded-lg text-white mb-3">
      <p class="text-center">Please wait while we process your image...</p>
      <div class="flex justify-center mt-4">
        <span class="animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-white">
        </span>
      </div>
      <p class="text-center text-xs mt-2">If you are not redirected in 10 seconds, please click <%= link_to "here", image_path(@image) %> to refresh the page.</p>
    </div>
    <% end %>
    </div>
    
    

    <div class="w-full md:w-1/3 p-4">
      <%  if @image.status == "error" %>
          <div class="bg-red-600 p-3 m-2 rounded-lg text-white">
            <%= @image.error_message %>
          </div>
      <% elsif current_user.tokens < 1 %>
          <div class="bg-red-600 p-3 m-2 rounded-lg text-white text-center">
            You have no tokens left. Please purchase more tokens to generate more images.
          </div>
      <% else %>
      <%= button_to "Generate AI Image", generate_image_path(@image), 
            method: :post, 
            class: "bg-green-600 hover:bg-green-700 p-3 m-2 rounded-lg text-white w-full" if @ready_to_send %>
      <% end %>

          <p class="text-center text-gray-600">
            <%= @image.image_prompt %>
          </p>
          <p class="text-center text-gray-600">
            <%= @image.status if current_user.admin? %>
          </p>
    </div>
  </div>

  <%= turbo_stream_from :doc_list %>
  <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6 mt-6" id="<%=@image.id%>_docs_list">
    <%# <%= render @image.docs_for_user(current_user), current_user: current_user %>
    <% @image_docs.each do |doc| %>
      <%= render "docs/doc", doc: doc, viewing_user: current_user %>
    <% end %>
  </div>

  <div class="mt-6 flex justify-center space-x-4">
    <%= button_to "Edit this image", edit_image_path(@image), method: :get, class: "text-blue-500 hover:text-blue-700 font-medium py-2 px-4 rounded-md" %>
    <%= button_to "Back to images", images_path, method: :get, class: "text-blue-500 hover:text-blue-700 font-medium py-2 px-4 rounded-md" %>
    <%= button_to "Destroy this image", @image, method: :delete, class: "text-red-500 hover:text-red-700 font-medium py-2 px-4 rounded-md", data: { turbo_method: :delete, turbo_confirm: "Are you sure?"} %>
  </div>
</div>

  